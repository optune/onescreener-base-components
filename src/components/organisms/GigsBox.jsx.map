{"version":3,"file":"GigsBox.jsx","sources":["GigsBox.jsx"],"sourcesContent":["/* eslint-disable react/prop-types */\nimport React, { Fragment, useState, useEffect } from 'react'\nimport styled from 'styled-components'\nimport { useMediaQuery } from 'react-responsive'\n\nimport { TextBox } from './TextBox.jsx'\n\nimport { AutoTextFit } from '../../utils/AutoTextFit.jsx'\n\nimport { getGigs, Type } from '../../api/gigs/index.js'\n\nimport { MediaSmall } from '../../style/media.js'\n\nconst TextAlign = {\n  CENTER_LEFT: 'left',\n  CENTER_CENTER: 'center',\n  CENTER_RIGHT: 'right',\n}\n\nconst InfoContainer = styled.div`\n  position: relative;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  opacity: ${({ active }) => (active ? 1 : 0)};\n  transition: opacity 0.3s ease-out;\n\n  & h2, p, span {\n    font-size: 1em;\n    color: ${({ color }) => color};\n    text-align: ${({ alignHorizontal }) => TextAlign[alignHorizontal]};\n    line-height: 1.4;\n    margin: 0 0 0.1em;\n    padding: 0;\n  }\n\n  & .separator-line {\n    background: ${({ color }) => color};\n    height: 0.1em;\n    min-height: 1px;\n    margin 1em 0;\n    padding: 0;\n    border: none;\n  }\n\n  & h2 {\n    font-size: 1.5em;\n    font-weight: bold;\n  }\n\n`\n\nconst GigHead = styled.h2`\n  text-align: ${({ alignHorizontal }) => TextAlign[alignHorizontal]};\n`\n\nconst GigList = styled.ul`\n  padding: 0;\n  margin: 0;\n`\n\nconst Gig = styled.li`\n  padding: 8px;\n  list-style: none;\n  line-height: 1.5;\n  margin: 1em 0;\n  transition: all 0.3s ease-out;\n  text-align: ${({ alignHorizontal }) => TextAlign[alignHorizontal]};\n`\n\nconst StartDate = styled.span`\n  width: 7em;\n`\nconst Event = styled.span`\n  min-width: 10em;\n\n  & a {\n    text-decoration: underline ${({ color }) => color};\n\n    & :hover {\n      color: ${({ colorAccent }) => colorAccent};\n      text-decoration: underline ${({ colorAccent }) => colorAccent};\n    }\n  }\n`\nconst Venue = styled.span`\n  min-width: 10em;\n`\n\nconst ShowMoreContainer = styled.div`\n  padding-top: 1.5em;\n\n  & p {\n    text-align: ${({ alignHorizontal }) => TextAlign[alignHorizontal]};\n  }\n`\n\nconst GigsTitle = ({ title, alignHorizontal, withLine }) => (\n  <Fragment>\n    <GigHead alignHorizontal={alignHorizontal}>{title}</GigHead>\n    {withLine && <hr className=\"separator-line\" />}\n  </Fragment>\n)\n\nconst MonthItem = ({ month, alignHorizontal }) => {\n  return (\n    <Gig alignHorizontal={alignHorizontal}>\n      <hr className=\"separator-line\" />\n      <b>{month.month}</b>\n      {' | '}\n      {month.year}\n    </Gig>\n  )\n}\n\nconst GigDate = (startDate, showDay) => (showDay ? startDate.day : startDate.formattedDate)\nconst GigTitle = (title, venue) => (title > '' ? title : venue.name)\nconst GigVenue = (title, venue) =>\n  title > ''\n    ? `${venue.name || ''}${(venue.name > '' && venue.city > '' && ', ') || ''}${venue.city || ''}`\n    : venue.city || ''\n\nconst GigItem = ({ gig, alignHorizontal, showDay }) => {\n  const { title, startDate, venue, website } = gig\n\n  const gigDate = GigDate(startDate, showDay)\n  const gigTitle = GigTitle(title, venue)\n  const gigVenue = GigVenue(title, venue)\n\n  return (\n    <Gig alignHorizontal={alignHorizontal}>\n      {gigDate}\n      {' | '}\n      {website ? (\n        <a href={website} target=\"_blank\" rel=\"noopener noreferrer\">\n          {gigTitle}\n        </a>\n      ) : (\n        gigTitle\n      )}\n      {gigVenue > '' && ' | '}\n      {gigVenue}\n    </Gig>\n  )\n}\n\nexport const GigsBox = ({\n  alignHorizontal,\n  border,\n  circle,\n  color,\n  colorAccent,\n  colorBackground,\n  colorBackgroundAccent,\n  gigsAPI,\n  gigsList,\n  square,\n}) => {\n  // SSR State\n  const [ssrDone, setSsrDone] = useState(false)\n  useEffect(() => {\n    if (!ssrDone) setSsrDone(true)\n  }, [ssrDone])\n\n  // Gigs State\n  const [gigs, setGigs] = useState(\n    Array.isArray(gigsList) ? { loading: false, data: gigsList } : { loading: true, data: [] }\n  )\n\n  useEffect(() => {\n    if (gigs.loading) {\n      getGigs(gigsAPI).then(data => {\n        setGigs({ loading: false, data })\n      })\n    }\n  }, [gigs.loading])\n\n  const showGigs = !gigs.loading && gigs.data.length > 0\n\n  // Media Query\n  const isSmall = useMediaQuery({ query: MediaSmall })\n\n  return (\n    <Fragment>\n      {/*\n       * Loading and no gigs message\n       */}\n\n      <InfoContainer color={color} alignHorizontal={alignHorizontal} active={!showGigs}>\n        <AutoTextFit\n          alignHorizontal={alignHorizontal}\n          colorBackground={colorBackground}\n          includeWidth\n          adjustWidth\n        >\n          <GigsTitle\n            alignHorizontal={alignHorizontal}\n            color={color}\n            title={gigsAPI.title}\n            withLine={gigsAPI.includeMonthTitle}\n          />\n          <p>{gigs.loading ? 'Loading gigs ...' : 'No gigs found'}</p>\n        </AutoTextFit>\n      </InfoContainer>\n\n      {/*\n       * Gigs List\n       */}\n\n      {showGigs && (\n        <TextBox\n          alignHorizontal={alignHorizontal}\n          color={color}\n          colorAccent={colorAccent}\n          colorBackground={colorBackground}\n          colorBackgroundAccent={colorBackgroundAccent}\n          wordWrap={ssrDone && isSmall}\n          adjustWidth\n        >\n          {/*\n           * Gigs List\n           */}\n\n          <GigsTitle alignHorizontal={alignHorizontal} title={gigsAPI.title} />\n          <GigList>\n            {gigs.data.map(({ type, ...gig }, key) =>\n              type === Type.MONTH ? (\n                <MonthItem key={key} month={gig} alignHorizontal={alignHorizontal} />\n              ) : (\n                <GigItem\n                  key={key}\n                  alignHorizontal={alignHorizontal}\n                  showDay={gigsAPI.includeMonthTitle}\n                  gig={gig}\n                />\n              )\n            )}\n          </GigList>\n\n          {/*\n           * Show More\n           */}\n\n          {gigsAPI.includeShowMore && (\n            <ShowMoreContainer alignHorizontal={alignHorizontal}>\n              <p>\n                <a\n                  href={`https://api.optune.me/v4/events/${\n                    gigsAPI.slug\n                  }?header=1&theme=black&ticketlinks=true`}\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                >\n                  Show More\n                </a>\n              </p>\n            </ShowMoreContainer>\n          )}\n        </TextBox>\n      )}\n    </Fragment>\n  )\n}\n"],"names":["TextAlign","CENTER_LEFT","CENTER_CENTER","CENTER_RIGHT","InfoContainer","styled","div","active","color","alignHorizontal","GigHead","h2","GigList","ul","Gig","li","StartDate","span","Event","colorAccent","Venue","ShowMoreContainer","GigsTitle","title","withLine","MonthItem","month","year","GigDate","startDate","showDay","day","formattedDate","GigTitle","venue","name","GigVenue","city","GigItem","gig","website","gigDate","gigTitle","gigVenue","GigsBox","border","circle","colorBackground","colorBackgroundAccent","gigsAPI","gigsList","square","ssrDone","setSsrDone","useState","useEffect","gigs","setGigs","Array","isArray","loading","data","getGigs","then","showGigs","length","isSmall","useMediaQuery","query","MediaSmall","includeMonthTitle","map","type","key","Type","MONTH","includeShowMore","slug"],"mappings":";;;;;;;;AAAA;AAaA,MAAMA,SAAS,GAAG;AAChBC,EAAAA,WAAW,EAAE,MADG;AAEhBC,EAAAA,aAAa,EAAE,QAFC;AAGhBC,EAAAA,YAAY,EAAE;AAHE,CAAlB;AAMA,MAAMC,aAAa,GAAGC,MAAM,CAACC,GAAI;;;;;aAKpB,CAAC;AAAEC,EAAAA;AAAF,CAAD,KAAiBA,MAAM,GAAG,CAAH,GAAO,CAAG;;;;;aAKjC,CAAC;AAAEC,EAAAA;AAAF,CAAD,KAAeA,KAAM;kBAChB,CAAC;AAAEC,EAAAA;AAAF,CAAD,KAAyBT,SAAS,CAACS,eAAD,CAAkB;;;;;;;kBAOpD,CAAC;AAAED,EAAAA;AAAF,CAAD,KAAeA,KAAM;;;;;;;;;;;;;CAlBvC;AAiCA,MAAME,OAAO,GAAGL,MAAM,CAACM,EAAG;gBACV,CAAC;AAAEF,EAAAA;AAAF,CAAD,KAAyBT,SAAS,CAACS,eAAD,CAAkB;CADpE;AAIA,MAAMG,OAAO,GAAGP,MAAM,CAACQ,EAAG;;;CAA1B;AAKA,MAAMC,GAAG,GAAGT,MAAM,CAACU,EAAG;;;;;;gBAMN,CAAC;AAAEN,EAAAA;AAAF,CAAD,KAAyBT,SAAS,CAACS,eAAD,CAAkB;CANpE;AASA,MAAMO,SAAS,GAAGX,MAAM,CAACY,IAAK;;CAA9B;AAGA,MAAMC,KAAK,GAAGb,MAAM,CAACY,IAAK;;;;iCAIO,CAAC;AAAET,EAAAA;AAAF,CAAD,KAAeA,KAAM;;;eAGvC,CAAC;AAAEW,EAAAA;AAAF,CAAD,KAAqBA,WAAY;mCACb,CAAC;AAAEA,EAAAA;AAAF,CAAD,KAAqBA,WAAY;;;CARpE;AAYA,MAAMC,KAAK,GAAGf,MAAM,CAACY,IAAK;;CAA1B;AAIA,MAAMI,iBAAiB,GAAGhB,MAAM,CAACC,GAAI;;;;kBAInB,CAAC;AAAEG,EAAAA;AAAF,CAAD,KAAyBT,SAAS,CAACS,eAAD,CAAkB;;CAJtE;;AAQA,MAAMa,SAAS,GAAG,CAAC;AAAEC,EAAAA,KAAF;AAASd,EAAAA,eAAT;AAA0Be,EAAAA;AAA1B,CAAD,KAChB,oBAAC,QAAD,QACE,oBAAC,OAAD;AAAS,EAAA,eAAe,EAAEf;AAA1B,GAA4Cc,KAA5C,CADF,EAEGC,QAAQ,IAAI;AAAI,EAAA,SAAS,EAAC;AAAd,EAFf,CADF;;AAOA,MAAMC,SAAS,GAAG,CAAC;AAAEC,EAAAA,KAAF;AAASjB,EAAAA;AAAT,CAAD,KAAgC;AAChD,SACE,oBAAC,GAAD;AAAK,IAAA,eAAe,EAAEA;AAAtB,KACE;AAAI,IAAA,SAAS,EAAC;AAAd,IADF,EAEE,+BAAIiB,KAAK,CAACA,KAAV,CAFF,EAGG,KAHH,EAIGA,KAAK,CAACC,IAJT,CADF;AAQD,CATD;;AAWA,MAAMC,OAAO,GAAG,CAACC,SAAD,EAAYC,OAAZ,KAAyBA,OAAO,GAAGD,SAAS,CAACE,GAAb,GAAmBF,SAAS,CAACG,aAA7E;;AACA,MAAMC,QAAQ,GAAG,CAACV,KAAD,EAAQW,KAAR,KAAmBX,KAAK,GAAG,EAAR,GAAaA,KAAb,GAAqBW,KAAK,CAACC,IAA/D;;AACA,MAAMC,QAAQ,GAAG,CAACb,KAAD,EAAQW,KAAR,KACfX,KAAK,GAAG,EAAR,GACK,GAAEW,KAAK,CAACC,IAAN,IAAc,EAAG,GAAGD,KAAK,CAACC,IAAN,GAAa,EAAb,IAAmBD,KAAK,CAACG,IAAN,GAAa,EAAhC,IAAsC,IAAvC,IAAgD,EAAG,GAAEH,KAAK,CAACG,IAAN,IAAc,EAAG,EADhG,GAEIH,KAAK,CAACG,IAAN,IAAc,EAHpB;;AAKA,MAAMC,OAAO,GAAG,CAAC;AAAEC,EAAAA,GAAF;AAAO9B,EAAAA,eAAP;AAAwBqB,EAAAA;AAAxB,CAAD,KAAuC;AACrD,QAAM;AAAEP,IAAAA,KAAF;AAASM,IAAAA,SAAT;AAAoBK,IAAAA,KAApB;AAA2BM,IAAAA;AAA3B,MAAuCD,GAA7C;AAEA,QAAME,OAAO,GAAGb,OAAO,CAACC,SAAD,EAAYC,OAAZ,CAAvB;AACA,QAAMY,QAAQ,GAAGT,QAAQ,CAACV,KAAD,EAAQW,KAAR,CAAzB;AACA,QAAMS,QAAQ,GAAGP,QAAQ,CAACb,KAAD,EAAQW,KAAR,CAAzB;AAEA,SACE,oBAAC,GAAD;AAAK,IAAA,eAAe,EAAEzB;AAAtB,KACGgC,OADH,EAEG,KAFH,EAGGD,OAAO,GACN;AAAG,IAAA,IAAI,EAAEA,OAAT;AAAkB,IAAA,MAAM,EAAC,QAAzB;AAAkC,IAAA,GAAG,EAAC;AAAtC,KACGE,QADH,CADM,GAKNA,QARJ,EAUGC,QAAQ,GAAG,EAAX,IAAiB,KAVpB,EAWGA,QAXH,CADF;AAeD,CAtBD;;MAwBaC,OAAO,GAAG,CAAC;AACtBnC,EAAAA,eADsB;AAEtBoC,EAAAA,MAFsB;AAGtBC,EAAAA,MAHsB;AAItBtC,EAAAA,KAJsB;AAKtBW,EAAAA,WALsB;AAMtB4B,EAAAA,eANsB;AAOtBC,EAAAA,qBAPsB;AAQtBC,EAAAA,OARsB;AAStBC,EAAAA,QATsB;AAUtBC,EAAAA;AAVsB,CAAD,KAWjB;AACJ;AACA,QAAM,CAACC,OAAD,EAAUC,UAAV,IAAwBC,QAAQ,CAAC,KAAD,CAAtC;AACAC,EAAAA,SAAS,CAAC,MAAM;AACd,QAAI,CAACH,OAAL,EAAcC,UAAU,CAAC,IAAD,CAAV;AACf,GAFQ,EAEN,CAACD,OAAD,CAFM,CAAT,CAHI;;AAQJ,QAAM,CAACI,IAAD,EAAOC,OAAP,IAAkBH,QAAQ,CAC9BI,KAAK,CAACC,OAAN,CAAcT,QAAd,IAA0B;AAAEU,IAAAA,OAAO,EAAE,KAAX;AAAkBC,IAAAA,IAAI,EAAEX;AAAxB,GAA1B,GAA+D;AAAEU,IAAAA,OAAO,EAAE,IAAX;AAAiBC,IAAAA,IAAI,EAAE;AAAvB,GADjC,CAAhC;AAIAN,EAAAA,SAAS,CAAC,MAAM;AACd,QAAIC,IAAI,CAACI,OAAT,EAAkB;AAChBE,MAAAA,OAAO,CAACb,OAAD,CAAP,CAAiBc,IAAjB,CAAsBF,IAAI,IAAI;AAC5BJ,QAAAA,OAAO,CAAC;AAAEG,UAAAA,OAAO,EAAE,KAAX;AAAkBC,UAAAA;AAAlB,SAAD,CAAP;AACD,OAFD;AAGD;AACF,GANQ,EAMN,CAACL,IAAI,CAACI,OAAN,CANM,CAAT;AAQA,QAAMI,QAAQ,GAAG,CAACR,IAAI,CAACI,OAAN,IAAiBJ,IAAI,CAACK,IAAL,CAAUI,MAAV,GAAmB,CAArD,CApBI;;AAuBJ,QAAMC,OAAO,GAAGC,aAAa,CAAC;AAAEC,IAAAA,KAAK,EAAEC;AAAT,GAAD,CAA7B;AAEA,SACE,oBAAC,QAAD,QAKE,oBAAC,aAAD;AAAe,IAAA,KAAK,EAAE7D,KAAtB;AAA6B,IAAA,eAAe,EAAEC,eAA9C;AAA+D,IAAA,MAAM,EAAE,CAACuD;AAAxE,KACE,oBAAC,WAAD;AACE,IAAA,eAAe,EAAEvD,eADnB;AAEE,IAAA,eAAe,EAAEsC,eAFnB;AAGE,IAAA,YAAY,MAHd;AAIE,IAAA,WAAW;AAJb,KAME,oBAAC,SAAD;AACE,IAAA,eAAe,EAAEtC,eADnB;AAEE,IAAA,KAAK,EAAED,KAFT;AAGE,IAAA,KAAK,EAAEyC,OAAO,CAAC1B,KAHjB;AAIE,IAAA,QAAQ,EAAE0B,OAAO,CAACqB;AAJpB,IANF,EAYE,+BAAId,IAAI,CAACI,OAAL,GAAe,kBAAf,GAAoC,eAAxC,CAZF,CADF,CALF,EA0BGI,QAAQ,IACP,oBAAC,OAAD;AACE,IAAA,eAAe,EAAEvD,eADnB;AAEE,IAAA,KAAK,EAAED,KAFT;AAGE,IAAA,WAAW,EAAEW,WAHf;AAIE,IAAA,eAAe,EAAE4B,eAJnB;AAKE,IAAA,qBAAqB,EAAEC,qBALzB;AAME,IAAA,QAAQ,EAAEI,OAAO,IAAIc,OANvB;AAOE,IAAA,WAAW;AAPb,KAaE,oBAAC,SAAD;AAAW,IAAA,eAAe,EAAEzD,eAA5B;AAA6C,IAAA,KAAK,EAAEwC,OAAO,CAAC1B;AAA5D,IAbF,EAcE,oBAAC,OAAD,QACGiC,IAAI,CAACK,IAAL,CAAUU,GAAV,CAAc,CAAC;AAAEC,IAAAA,IAAF;AAAQ,OAAGjC;AAAX,GAAD,EAAmBkC,GAAnB,KACbD,IAAI,KAAKE,IAAI,CAACC,KAAd,GACE,oBAAC,SAAD;AAAW,IAAA,GAAG,EAAEF,GAAhB;AAAqB,IAAA,KAAK,EAAElC,GAA5B;AAAiC,IAAA,eAAe,EAAE9B;AAAlD,IADF,GAGE,oBAAC,OAAD;AACE,IAAA,GAAG,EAAEgE,GADP;AAEE,IAAA,eAAe,EAAEhE,eAFnB;AAGE,IAAA,OAAO,EAAEwC,OAAO,CAACqB,iBAHnB;AAIE,IAAA,GAAG,EAAE/B;AAJP,IAJH,CADH,CAdF,EAiCGU,OAAO,CAAC2B,eAAR,IACC,oBAAC,iBAAD;AAAmB,IAAA,eAAe,EAAEnE;AAApC,KACE,+BACE;AACE,IAAA,IAAI,EAAG,mCACLwC,OAAO,CAAC4B,IACT,wCAHH;AAIE,IAAA,MAAM,EAAC,QAJT;AAKE,IAAA,GAAG,EAAC;AALN,iBADF,CADF,CAlCJ,CA3BJ,CADF;AAgFD;;;;"}